<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>“SpringFox源码解析&#34; - 无名鼠辈</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Lyf" />
  <meta name="description" content="SpringFox源码分析-自定义Model、Enum 先说一说Springfox和Swagger的关系 Swagger 是一种规范。 springfox-swagger 是基于 Spring 生态系统的该规" />







<meta name="generator" content="Hugo 0.55.6" />


<link rel="canonical" href="https://llc687.top/post/springfox%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E8%87%AA%E5%AE%9A%E4%B9%89modelenum/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="“SpringFox源码解析&#34;" />
<meta property="og:description" content="SpringFox源码分析-自定义Model、Enum 先说一说Springfox和Swagger的关系 Swagger 是一种规范。 springfox-swagger 是基于 Spring 生态系统的该规" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://llc687.top/post/springfox%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E8%87%AA%E5%AE%9A%E4%B9%89modelenum/" />
<meta property="article:published_time" content="2019-12-01T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-12-01T00:00:00&#43;00:00"/>

<meta itemprop="name" content="“SpringFox源码解析&#34;">
<meta itemprop="description" content="SpringFox源码分析-自定义Model、Enum 先说一说Springfox和Swagger的关系 Swagger 是一种规范。 springfox-swagger 是基于 Spring 生态系统的该规">


<meta itemprop="datePublished" content="2019-12-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-12-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="4628">



<meta itemprop="keywords" content="SpringFox,“Swagger&#34;," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="“SpringFox源码解析&#34;"/>
<meta name="twitter:description" content="SpringFox源码分析-自定义Model、Enum 先说一说Springfox和Swagger的关系 Swagger 是一种规范。 springfox-swagger 是基于 Spring 生态系统的该规"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">无名鼠辈</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/about/">关于</a>
          
        
      </li>
    

    
      <li class="mobile-menu-item">
        <a id="openSearchMobile" class="mobile-menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  
    
<div class="modal-dialog">
    
    <div class="modal-content">
      <div id="closeSearch" title="Close" class="close">X</div>
      <div class="modal-header">
        <div class="modal-title">Search</div>
      </div>
      <div class="modal-body">
          <script>
            (function() {
              var cx = '014783502852757998779:nk1fvw21g2i';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = (document.location.protocol == 'https:' ? 'https:' :
                  'http:') +
                '//cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
            })();
          </script>
          <gcse:search></gcse:search>
      </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      无名鼠辈
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llc687.top/about/">关于</a>
          

        

      </li>
    

    
    

    
      <li class="menu-item">
        <a id="openSearch" class="menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">“SpringFox源码解析&#34;</h1>
      
      <div class="post-meta">
        <time datetime="2019-12-01" class="post-time">
          2019-12-01
        </time>
        <div class="post-category">
            <a href="https://llc687.top/categories/swagger/"> “Swagger&#34; </a>
            
          </div>
        <span class="more-meta"> 约 4628 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#springfox源码分析-自定义model-enum">SpringFox源码分析-自定义Model、Enum</a></li>
<li><a href="#1-get-方法的参数对象">1. GET 方法的参数对象</a></li>
<li><a href="#2-enum的描述格式">2. Enum的描述格式</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h4 id="springfox源码分析-自定义model-enum">SpringFox源码分析-自定义Model、Enum</h4>

<p>先说一说<a href="https://github.com/springfox/springfox">Springfox</a>和Swagger的关系</p>

<blockquote>
<p>Swagger 是一种规范。</p>

<p>springfox-swagger 是基于 Spring 生态系统的该规范的实现。</p>

<p>springfox-swagger-ui 是对 swagger-ui 的封装，使得其可以使用 Spring 的服务。</p>
</blockquote>

<p>由于工作中遇到需要基于 Swagger Json 做一些处理，但 Swagger Json 的格式不是那么满足需求。</p>

<blockquote>
<p>本文springfox-swagger版本号：<code>2.6.0</code></p>
</blockquote>

<p>本文从问题出发，探索涉及的源码。</p>

<h4 id="1-get-方法的参数对象">1. GET 方法的参数对象</h4>

<p>第一个问题，当方法是GET请求，但参数是一个自定义 Object，在展示时（生成的JSON）是不包括本 Object 描述的。所以，就要看看什么时候会生成这些 Model 的描述。</p>

<p>万事有始有终，SpringFox始就在： <code>springfox.documentation.spring.web.plugins</code>下的 <code>DocumentationPluginsBootstrapper</code>。</p>

<p>该类实现了 <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/SmartLifecycle.html">SmartLifecycle</a> 接口，实现此接口且通过<code>@Component</code>注入到容器的bean, 容器初始化后会执行<code>start()</code>方法.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentationPluginsBootstrapper</span> <span class="kd">implements</span> <span class="n">SmartLifecycle</span> <span class="o">{</span></code></pre></td></tr></table>
</div>
</div>
<p>接着看 start 方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">initialized</span><span class="o">.</span><span class="na">compareAndSet</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="kc">true</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// 拿到 DocumentationPlugin 插件
</span><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">DocumentationPlugin</span><span class="o">&gt;</span> <span class="n">plugins</span> <span class="o">=</span> <span class="n">pluginOrdering</span><span class="o">()</span>
            <span class="o">.</span><span class="na">sortedCopy</span><span class="o">(</span><span class="n">documentationPluginsManager</span><span class="o">.</span><span class="na">documentationPlugins</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">DocumentationPlugin</span> <span class="n">each</span> <span class="o">:</span> <span class="n">plugins</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//获取文档类型
</span><span class="c1"></span>            <span class="n">DocumentationType</span> <span class="n">documentationType</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="na">getDocumentationType</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">each</span><span class="o">.</span><span class="na">isEnabled</span><span class="o">())</span> <span class="o">{</span>
                <span class="c1">// 启用则扫描生成文档
</span><span class="c1"></span>                <span class="n">scanDocumentation</span><span class="o">(</span><span class="n">buildContext</span><span class="o">(</span><span class="n">each</span><span class="o">));</span>
            <span class="o">}</span> 
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>调用了 <code>buildContext</code> 方法, 通过 Docket 对象创建 DocumentaionContext 对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="n">DocumentationContext</span> <span class="nf">buildContext</span><span class="o">(</span><span class="n">DocumentationPlugin</span> <span class="n">each</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">each</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">defaultContextBuilder</span><span class="o">(</span><span class="n">each</span><span class="o">));</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>再往下走</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="n">DocumentationContextBuilder</span> <span class="nf">defaultContextBuilder</span><span class="o">(</span><span class="n">DocumentationPlugin</span> <span class="n">each</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">DocumentationType</span> <span class="n">documentationType</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="na">getDocumentationType</span><span class="o">();</span>
    <span class="c1">// 获取所有的RequestHnadler
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">RequestHandler</span><span class="o">&gt;</span> <span class="n">requestHandlers</span> <span class="o">=</span> <span class="n">FluentIterable</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">handlerProviders</span><span class="o">).</span><span class="na">transformAndConcat</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">handlers</span><span class="o">()).</span><span class="na">toList</span><span class="o">();</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">documentationPluginsManager</span><span class="o">.</span><span class="na">createContextBuilder</span><span class="o">(</span><span class="n">documentationType</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">defaultConfiguration</span><span class="o">).</span><span class="na">requestHandlers</span><span class="o">(</span><span class="n">requestHandlers</span><span class="o">);</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>handlerProviders</code> 是 <code>RequestHandlerProvider</code> 接口，实现类是 <code>WebMvcRequestHandlerProvider</code>,其中 <code>requestHandlers</code> 方法会接收Spring中的所有请求映射。</p>

<p>接着看 <code>DocumentationContextBuilder</code>的构造过程：<code>documentationPluginsManager.createContextBuilder</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">DocumentationContextBuilder</span> <span class="nf">createContextBuilder</span><span class="o">(</span><span class="n">DocumentationType</span> <span class="n">documentationType</span><span class="o">,</span>
                                                        <span class="n">DefaultConfiguration</span> <span class="n">defaultConfiguration</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">defaultsProviders</span><span class="o">.</span><span class="na">getPluginFor</span><span class="o">(</span><span class="n">documentationType</span><span class="o">,</span> <span class="n">defaultConfiguration</span><span class="o">)</span>
      <span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">documentationType</span><span class="o">)</span>
      <span class="o">.</span><span class="na">withResourceGroupingStrategy</span><span class="o">(</span><span class="n">resourceGroupingStrategy</span><span class="o">(</span><span class="n">documentationType</span><span class="o">));</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>defaultsProviders</code> 是也是一个插件接口 <code>DefaultsProviderPlugin</code>，只有一个实现类<code>DefaultConfiguration</code>，不过该类未使用<code>@Compoent</code>注解，所以需要给一个替换值<code>defaultConfiguration</code>，也就是<code>DefaultConfiguration</code>。在看<code>DefaultConfiguration</code>的<code>create</code>方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">DocumentationContextBuilder</span> <span class="nf">create</span><span class="o">(</span><span class="n">DocumentationType</span> <span class="n">documentationType</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">DocumentationContextBuilder</span><span class="o">(</span><span class="n">documentationType</span><span class="o">)</span>
          <span class="o">.</span><span class="na">operationOrdering</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">operationOrdering</span><span class="o">())</span>
          <span class="o">.</span><span class="na">apiDescriptionOrdering</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">apiDescriptionOrdering</span><span class="o">())</span>
          <span class="o">.</span><span class="na">apiListingReferenceOrdering</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">apiListingReferenceOrdering</span><span class="o">())</span>
          <span class="o">.</span><span class="na">additionalIgnorableTypes</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">defaultIgnorableParameterTypes</span><span class="o">())</span>
          <span class="o">.</span><span class="na">rules</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">defaultRules</span><span class="o">(</span><span class="n">typeResolver</span><span class="o">))</span>
          <span class="o">.</span><span class="na">defaultResponseMessages</span><span class="o">(</span><span class="n">defaults</span><span class="o">.</span><span class="na">defaultResponseMessages</span><span class="o">())</span>
          <span class="o">.</span><span class="na">pathProvider</span><span class="o">(</span><span class="k">new</span> <span class="n">RelativePathProvider</span><span class="o">(</span><span class="n">servletContext</span><span class="o">))</span>
          <span class="o">.</span><span class="na">typeResolver</span><span class="o">(</span><span class="n">typeResolver</span><span class="o">)</span>
          <span class="o">.</span><span class="na">enableUrlTemplating</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
          <span class="o">.</span><span class="na">selector</span><span class="o">(</span><span class="n">ApiSelector</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">);</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这里在给<code>DocumentationContextBuilder</code>设置相关参数，至此拿到了 <code>DocumentationContextBuilder</code></p>

<p>回到上面提到的<code>buildContext</code>方法，<code>defaultContextBuilder</code>方法执行完毕，接下来是 <code>configure</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="k">return</span> <span class="n">each</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">defaultContextBuilder</span><span class="o">(</span><span class="n">each</span><span class="o">));</span></code></pre></td></tr></table>
</div>
</div>
<p><code>DocumentationPlugin</code>只有一个实现类<code>Docket</code>，到这里就有点熟悉了。<code>Docket</code>对象是我们开发人员在外部通过<code>@Bean</code>来创建的，而外部赋值的对象值，最终都会整合到<code>DocumentationContext</code>。这里的<code>config</code>就是在二次赋值。可以看一下一般自己定义的<code>Docket</code>对象。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SwaggerConfig</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">Docket</span> <span class="nf">docket</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Docket</span><span class="o">(</span><span class="n">DocumentationType</span><span class="o">.</span><span class="na">SWAGGER_2</span><span class="o">)</span>
                <span class="o">.</span><span class="na">groupName</span><span class="o">(</span><span class="n">SWAGGER_GROUP</span><span class="o">)</span>
                <span class="o">.</span><span class="na">apiInfo</span><span class="o">(</span><span class="k">new</span> <span class="n">ApiInfoBuilder</span><span class="o">().</span><span class="na">title</span><span class="o">(</span><span class="s">&#34;xx&#34;</span><span class="o">).</span><span class="na">version</span><span class="o">(</span><span class="s">&#34;1.0.0&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">())</span>
                <span class="o">......</span>
                <span class="o">.</span><span class="na">select</span><span class="o">()</span>
                <span class="o">.</span><span class="na">apis</span><span class="o">(</span><span class="n">basePackage</span><span class="o">(</span><span class="s">&#34;xxx&#34;</span><span class="o">))</span>
                <span class="o">.</span><span class="na">paths</span><span class="o">(</span><span class="n">PathSelectors</span><span class="o">.</span><span class="na">any</span><span class="o">())</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>到这里实际只设置了默认的参数。但接口，定义，模型等关键信息等都未初始化。</p>

<p>回到最初<code>start()</code>, 看看<code>scanDocumentation(buildContext(each))</code>的<code>scanDocumentation</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">scanDocumentation</span><span class="o">(</span><span class="n">DocumentationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">scanned</span><span class="o">.</span><span class="na">addDocumentation</span><span class="o">(</span><span class="n">resourceListing</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="n">context</span><span class="o">));</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>其中 <code>scan</code> 位于 <code>ApiDocumentationScanner</code>类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Documentation</span> <span class="nf">scan</span><span class="o">(</span><span class="n">DocumentationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ApiListingReferenceScanResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">apiListingReferenceScanner</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="o">...</span>
  <span class="n">Multimap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">ApiListing</span><span class="o">&gt;</span> <span class="n">apiListings</span> <span class="o">=</span> <span class="n">apiListingScanner</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="n">listingContext</span><span class="o">);</span>
  <span class="o">...</span></code></pre></td></tr></table>
</div>
</div>
<p><code>apiListingReferenceScanner.scan</code>位于 <code>ApiListingReferenceScanner</code>类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">ApiListingReferenceScanResult</span> <span class="nf">scan</span><span class="o">(</span><span class="n">DocumentationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="c1">// 接口选择器 在构建Docket时通过.select()默认配置 
</span><span class="c1"></span>  <span class="n">ApiSelector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getApiSelector</span><span class="o">();</span>
  <span class="c1">// 根据package路径(一般)或注解区分, 过滤筛选掉不符规则的 RequestHandler 接口
</span><span class="c1"></span>  <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">RequestHandler</span><span class="o">&gt;</span> <span class="n">matchingHandlers</span> <span class="o">=</span> <span class="n">from</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getRequestHandlers</span><span class="o">())</span>
      <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">getRequestHandlerSelector</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">RequestHandler</span> <span class="n">handler</span> <span class="o">:</span> <span class="n">matchingHandlers</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 接口分组 resourceGroup = Controller，RequestMapping = method
</span><span class="c1"></span>    <span class="n">ResourceGroup</span> <span class="n">resourceGroup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResourceGroup</span><span class="o">(</span><span class="n">handler</span><span class="o">.</span><span class="na">groupName</span><span class="o">(),</span>
        <span class="n">handler</span><span class="o">.</span><span class="na">declaringClass</span><span class="o">(),</span> <span class="n">0</span><span class="o">);</span>
    <span class="n">RequestMappingContext</span> <span class="n">requestMappingContext</span>
        <span class="o">=</span> <span class="k">new</span> <span class="n">RequestMappingContext</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
    <span class="n">resourceGroupRequestMappings</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">resourceGroup</span><span class="o">,</span> <span class="n">requestMappingContext</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">ApiListingReferenceScanResult</span><span class="o">(</span><span class="n">asMap</span><span class="o">(</span><span class="n">resourceGroupRequestMappings</span><span class="o">));</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>到这已经拿到了所有接口并进行了分组，其中<a href="https://guava.dev/releases/23.6-jre/api/docs/com/google/common/collect/ArrayListMultimap.html">ArrayListMultimap</a>是<code>guava</code>的方法。</p>

<p>再回到  <code>ApiDocumentationScanner</code>的 <code>scan</code>方法，看 <code>apiListingScanner.scan</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Multimap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">ApiListing</span><span class="o">&gt;</span> <span class="nf">scan</span><span class="o">(</span><span class="n">ApiListingScanningContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">ResourceGroup</span> <span class="n">resourceGroup</span> <span class="o">:</span> <span class="n">sortedByName</span><span class="o">(</span><span class="n">requestMappingsByResourceGroup</span><span class="o">.</span><span class="na">keySet</span><span class="o">()))</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">each</span> <span class="o">:</span> <span class="n">sortedByMethods</span><span class="o">(</span><span class="n">requestMappingsByResourceGroup</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">resourceGroup</span><span class="o">)))</span> <span class="o">{</span>
      <span class="c1">// 循环Controller下的所有接口的实例对象, 拿到该接口的所有Model
</span><span class="c1"></span>      <span class="n">models</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="n">apiModelReader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">each</span><span class="o">.</span><span class="na">withKnownModels</span><span class="o">(</span><span class="n">models</span><span class="o">)));</span>
      <span class="n">apiDescriptions</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">apiDescriptionReader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">each</span><span class="o">));</span>
    <span class="o">}</span>
    </code></pre></td></tr></table>
</div>
</div>
<p><code>each.withKnownModels</code> 是复制对象，主要看<code>apiModelReader.read</code>,读取该接口的 Model 信息。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="nf">read</span><span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
	<span class="c1">// 忽略的class
</span><span class="c1"></span>  <span class="n">Set</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&gt;</span> <span class="n">ignorableTypes</span> <span class="o">=</span> <span class="n">newHashSet</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getIgnorableParameterTypes</span><span class="o">());</span>
  <span class="n">Set</span><span class="o">&lt;</span><span class="n">ModelContext</span><span class="o">&gt;</span> <span class="n">modelContexts</span> <span class="o">=</span> <span class="n">pluginsManager</span><span class="o">.</span><span class="na">modelContexts</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="n">modelMap</span> <span class="o">=</span> <span class="n">newHashMap</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getModelMap</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">ModelContext</span> <span class="n">each</span> <span class="o">:</span> <span class="n">modelContexts</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">markIgnorablesAsHasSeen</span><span class="o">(</span><span class="n">typeResolver</span><span class="o">,</span> <span class="n">ignorableTypes</span><span class="o">,</span> <span class="n">each</span><span class="o">);</span>
    <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Model</span><span class="o">&gt;</span> <span class="n">pModel</span> <span class="o">=</span> <span class="n">modelProvider</span><span class="o">.</span><span class="na">modelFor</span><span class="o">(</span><span class="n">each</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pModel</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">mergeModelMap</span><span class="o">(</span><span class="n">modelMap</span><span class="o">,</span> <span class="n">pModel</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="o">}</span>
    <span class="n">populateDependencies</span><span class="o">(</span><span class="n">each</span><span class="o">,</span> <span class="n">modelMap</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">modelMap</span><span class="o">;</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>就是从 <code>modelContexts</code>转化为 <code>Model</code>，看看<code>pluginsManager.modelContexts</code>，怎么取<code>modelContexts</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">ModelContext</span><span class="o">&gt;</span> <span class="nf">modelContexts</span><span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">DocumentationType</span> <span class="n">documentationType</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getDocumentationContext</span><span class="o">().</span><span class="na">getDocumentationType</span><span class="o">();</span>
  <span class="c1">// 构建接口的ModelContext集合
</span><span class="c1"></span>  <span class="k">for</span> <span class="o">(</span><span class="n">OperationModelsProviderPlugin</span> <span class="n">each</span> <span class="o">:</span> <span class="n">operationModelsProviders</span><span class="o">.</span><span class="na">getPluginsFor</span><span class="o">(</span><span class="n">documentationType</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">each</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="na">operationModelsBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>OperationModelsProviderPlugin</code>有两个实现类，通过文档类型来获取。</p>

<ul>
<li>OperationModelsProviderPlugin：处理返回类型，参数类型等</li>
<li>SwaggerOperationModelsProvider：swagger注解提供的值类型，<code>@ApiResponse</code>，<code>@ApiOperation</code>等</li>
</ul>

<p>先看<code>OperationModelsProviderPlugin</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// 收集返回类型
</span><span class="c1"></span>  <span class="n">collectFromReturnType</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="c1">// 收集参数类型
</span><span class="c1"></span>  <span class="n">collectParameters</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="c1">// 收集接口型号
</span><span class="c1"></span>  <span class="n">collectGlobalModels</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>到了这，本问题（ GET 方法的请求Object不描述）的答案就要呼之欲出了。来看 <code>collectParameters</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">collectParameters</span><span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// 获取所有类型
</span><span class="c1"></span>  <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolvedMethodParameter</span><span class="o">&gt;</span> <span class="n">parameterTypes</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getParameters</span><span class="o">();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">ResolvedMethodParameter</span> <span class="n">parameterType</span> <span class="o">:</span> <span class="n">parameterTypes</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 过滤  
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">parameterType</span><span class="o">.</span><span class="na">hasParameterAnnotation</span><span class="o">(</span><span class="n">RequestBody</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
          <span class="o">||</span> <span class="n">parameterType</span><span class="o">.</span><span class="na">hasParameterAnnotation</span><span class="o">(</span><span class="n">RequestPart</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">ResolvedType</span> <span class="n">modelType</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">alternateFor</span><span class="o">(</span><span class="n">parameterType</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">());</span>
        <span class="n">context</span><span class="o">.</span><span class="na">operationModelsBuilder</span><span class="o">().</span><span class="na">addInputParam</span><span class="o">(</span><span class="n">modelType</span><span class="o">);</span>
      <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>破案了，可以看到过滤时只会处理两种：通过<code>@RequestBody</code>和<code>@ReuqestPart</code>注解标注的, 而GET方法的参数是不可以使用这两个注解的。（当然从规范来说，GET方法也不应该这种参数）。</p>

<p>至于<code>OperationModelsProviderPlugin</code>的另一个实现类<code>SwaggerOperationModelsProvider</code>主要是收集使用<code>@ApiOperation</code>时主句属性值和<code>@ApiResponse</code>响应状态码涉及到的型号，不再详细列出。</p>

<p>而<code>apiModelReader.read</code>中的 <code>modelContexts</code>转化为 <code>Model</code>的<code>modelProvider.modelFor()</code>是通过<code>ModelProvider</code>实现，下一个问题会详细阐述。</p>

<p>那么，如何解决这个问题：</p>

<ol>
<li><p>使用 <code>Docket</code>的<code>additionalModels</code>方法，在配置类中注入 <code>TypeResolver</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">return new Docket(DocumentationType.SWAGGER_2)
.additionalModels(typeResolver.resolve(xxx))
...</pre></td></tr></table>
</div>
</div></li>

<li><p>借助第三方类库 如<a href="https://github.com/xiaoymin/swagger-bootstrap-ui">swagger-bootstrap-ui</a>的工具类（我没接，但可以..）</p></li>

<li><p>重写</p></li>
</ol>

<p>重写<code>OperationModelsProviderPlugin</code>的<code>apply</code>方法，添加自定义收集器。或者直接重写 <code>collectParameters</code>也行。比如</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java">   <span class="kd">private</span> <span class="kt">void</span> <span class="nf">collectGetParameters</span><span class="o">(</span><span class="n">RequestMappingContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
       <span class="o">...</span>
       <span class="k">for</span> <span class="o">(</span><span class="n">ResolvedMethodParameter</span> <span class="n">parameterType</span> <span class="o">:</span> <span class="n">parameterTypes</span><span class="o">)</span> <span class="o">{</span>
           <span class="c1">// 不存在@RequestBody注解
</span><span class="c1"></span>           <span class="k">if</span> <span class="o">(!</span><span class="n">parameterType</span><span class="o">.</span><span class="na">hasParameterAnnotation</span><span class="o">(</span><span class="n">RequestBody</span><span class="o">.</span><span class="na">class</span><span class="o">)...)</span> <span class="o">{</span>
      					<span class="o">...</span>
               <span class="k">if</span> <span class="o">(</span><span class="n">xxx</span><span class="o">)</span> <span class="o">{</span>
                   <span class="n">ResolvedType</span> <span class="n">modelType</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">alternateFor</span><span class="o">(</span><span class="n">parameterType</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">());</span>
                   <span class="n">context</span><span class="o">.</span><span class="na">operationModelsBuilder</span><span class="o">().</span><span class="na">addInputParam</span><span class="o">(</span><span class="n">modelType</span><span class="o">);</span>
               <span class="o">}</span>
           <span class="o">}</span> <span class="o">...</span>
       <span class="o">}}</span></code></pre></td></tr></table>
</div>
</div>
<p>问题解决。</p>

<h4 id="2-enum的描述格式">2. Enum的描述格式</h4>

<p>问题是对于枚举类，在生成的JSON文件中描述是在原参数对象中的如下格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-JSON" data-lang="JSON"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JSON" data-lang="JSON">   <span class="s2">&#34;xxx&#34;</span><span class="err">:</span> <span class="p">{</span><span class="err">...</span><span class="p">}</span>
   <span class="s2">&#34;periodUnit&#34;</span><span class="err">:</span><span class="p">{</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span><span class="s2">&#34;string&#34;</span><span class="p">,</span>
      <span class="nt">&#34;enum&#34;</span><span class="p">:[</span>
               <span class="s2">&#34;MINUTE&#34;</span><span class="p">,</span>
               <span class="s2">&#34;HOUR&#34;</span>
               <span class="err">...</span>
         <span class="p">]}</span></code></pre></td></tr></table>
</div>
</div>
<p>一般枚举使用会如<code>MINUTE(1,“分钟”)</code>,也就是包括了<code>code</code>和<code>name</code>描述。</p>

<p>但实际<code>enum</code>的值会是二者之一。且不会生成如下的可重用的外部引用。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-JSON" data-lang="JSON"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JSON" data-lang="JSON"><span class="s2">&#34;schema&#34;</span><span class="err">:</span><span class="p">{</span>
          <span class="nt">&#34;$ref&#34;</span><span class="p">:</span><span class="s2">&#34;#/definitions/xxxForm&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>注意：可重用的问题在<code>3.0+</code>可以通过配置处理。</p>

<p>如果需要强制将<code>enum</code>的值设为<code>code</code>或<code>name</code>，或拓展更多的内容，就需要来看看，<code>enum</code>类何时会被处理。</p>

<p>上一个问题的结尾说到<code>apiModelReader.read</code>， <code>modelContexts</code>转化为 <code>Model</code>的<code>modelProvider.modelFor()</code>方法是通过<code>ModelProvider</code>实现，其实 ModelProvider`是接口，有两个实现类：</p>

<ul>
<li>DefaultModelProvider：默认，每次都会将modelContext转换为model</li>
<li>CachingModelProvider：声明了guava缓存池，先从缓存池取，没有则调用初始化处理器，转换为模型，再放入缓存池。</li>
</ul>

<p>在<code>ApiModelReader</code>的构造方法里指定了使用<code>CachingModelProvider</code>,不过第一次调用缓存里是没有的，所以往下走到<code>populateDependencies</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">populateDependencies</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="n">modelMap</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="n">dependencies</span> <span class="o">=</span> <span class="n">modelProvider</span><span class="o">.</span><span class="na">dependencies</span><span class="o">(</span><span class="n">modelContext</span><span class="o">);</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Model</span> <span class="n">each</span> <span class="o">:</span> <span class="n">dependencies</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">mergeModelMap</span><span class="o">(</span><span class="n">modelMap</span><span class="o">,</span> <span class="n">each</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>CachingModelProvider</code>的<code>dependencies</code>依赖的是<code>DefaultModelProvider</code>的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="nf">dependencies</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">delegate</span><span class="o">.</span><span class="na">dependencies</span><span class="o">(</span><span class="n">modelContext</span><span class="o">);</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>所以看<code>DefaultModelProvider</code>中的实现</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="nf">dependencies</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Model</span><span class="o">&gt;</span> <span class="n">models</span> <span class="o">=</span> <span class="n">newHashMap</span><span class="o">();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">ResolvedType</span> <span class="n">resolvedType</span> <span class="o">:</span> <span class="n">dependencyProvider</span><span class="o">.</span><span class="na">dependentModels</span><span class="o">(</span><span class="n">modelContext</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">ModelContext</span> <span class="n">parentContext</span> <span class="o">=</span> <span class="n">ModelContext</span><span class="o">.</span><span class="na">fromParent</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">);</span>
    <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Model</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">modelFor</span><span class="o">(</span><span class="n">parentContext</span><span class="o">).</span><span class="na">or</span><span class="o">(</span><span class="n">mapModel</span><span class="o">(</span><span class="n">parentContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">));</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">models</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">model</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">models</span><span class="o">;</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>dependencyProvider.dependentModels</code>和上面一个路子，一默认一缓存，交替接口。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">ResolvedType</span><span class="o">&gt;</span> <span class="nf">dependentModels</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">from</span><span class="o">(</span><span class="n">resolvedDependencies</span><span class="o">(</span><span class="n">modelContext</span><span class="o">))</span>
      <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">ignorableTypes</span><span class="o">(</span><span class="n">modelContext</span><span class="o">))</span>
      <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">not</span><span class="o">(</span><span class="n">baseTypes</span><span class="o">(</span><span class="n">modelContext</span><span class="o">)))</span>
      <span class="o">.</span><span class="na">toSet</span><span class="o">();</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>后面是两个过滤，暂且不提。看<code>resolvedDependencies</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolvedType</span><span class="o">&gt;</span> <span class="nf">resolvedDependencies</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolvedType</span><span class="o">&gt;</span> <span class="n">dependencies</span> <span class="o">=</span> <span class="n">newArrayList</span><span class="o">(</span><span class="n">resolvedTypeParameters</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">));</span>
  <span class="n">dependencies</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">resolvedArrayElementType</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">));</span>
  <span class="n">dependencies</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">resolvedPropertiesAndFields</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">));</span>
  <span class="o">...</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这里都是在构造拓展类型 <code>ResolvedType</code>,有一个叫<code>resolvedPropertiesAndFields</code>,看名字就是它了，进去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolvedType</span><span class="o">&gt;</span> <span class="nf">resolvedPropertiesAndFields</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">,</span> <span class="n">ResolvedType</span> <span class="n">resolvedType</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolvedType</span><span class="o">&gt;</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">newArrayList</span><span class="o">();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">ModelProperty</span> <span class="n">property</span> <span class="o">:</span> <span class="n">nonTrivialProperties</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">))</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">maybeFromCollectionElementType</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">property</span><span class="o">));</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">maybeFromMapValueType</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">property</span><span class="o">));</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">maybeFromRegularType</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">property</span><span class="o">));</span>
  <span class="o">}}</span></code></pre></td></tr></table>
</div>
</div>
<p>看到<code>ModelProperty</code>,也就是对象内部属性代表的Model了，那就看<code>nonTrivialProperties</code>方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">private</span> <span class="n">FluentIterable</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="nf">nonTrivialProperties</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">,</span> <span class="n">ResolvedType</span> <span class="n">resolvedType</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">from</span><span class="o">(</span><span class="n">propertiesFor</span><span class="o">(</span><span class="n">modelContext</span><span class="o">,</span> <span class="n">resolvedType</span><span class="o">))</span>
      <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">not</span><span class="o">(</span><span class="n">baseProperty</span><span class="o">(</span><span class="n">modelContext</span><span class="o">)));</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>之后是<code>propertiesFor</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="nf">propertiesFor</span><span class="o">(</span><span class="n">ModelContext</span> <span class="n">modelContext</span><span class="o">,</span> <span class="n">ResolvedType</span> <span class="n">resolvedType</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">propertiesProvider</span><span class="o">.</span><span class="na">propertiesFor</span><span class="o">(</span><span class="n">resolvedType</span><span class="o">,</span> <span class="n">modelContext</span><span class="o">);</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这个<code>propertiesProvider.propertiesFor</code>仍是一cache一default的策略，直接看实现</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="nf">propertiesFor</span><span class="o">(</span><span class="n">ResolvedType</span> <span class="n">type</span><span class="o">,</span> <span class="n">ModelContext</span> <span class="n">givenContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">BeanPropertyDefinition</span><span class="o">&gt;</span> <span class="n">each</span> <span class="o">:</span> <span class="n">propertyLookup</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">BeanPropertyDefinition</span> <span class="n">jacksonProperty</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
    <span class="n">Optional</span><span class="o">&lt;</span><span class="n">AnnotatedMember</span><span class="o">&gt;</span> <span class="n">annotatedMember</span>
        <span class="o">=</span> <span class="n">Optional</span><span class="o">.</span><span class="na">fromNullable</span><span class="o">(</span><span class="n">safeGetPrimaryMember</span><span class="o">(</span><span class="n">jacksonProperty</span><span class="o">));</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">annotatedMember</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">candidateProperties</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">annotatedMember</span><span class="o">.</span><span class="na">get</span><span class="o">(),</span> <span class="n">jacksonProperty</span><span class="o">,</span> <span class="n">givenContext</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}...</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>可以看到 <code>List&lt;ModelProperty&gt;</code>通过 <code>candidateProperties</code>方法获取</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@VisibleForTesting</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="nf">candidateProperties</span><span class="o">(</span>
    <span class="n">ResolvedType</span> <span class="n">type</span><span class="o">,</span>
    <span class="n">AnnotatedMember</span> <span class="n">member</span><span class="o">,</span>
    <span class="n">BeanPropertyDefinition</span> <span class="n">jacksonProperty</span><span class="o">,</span>
    <span class="n">ModelContext</span> <span class="n">givenContext</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">newArrayList</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="n">AnnotatedMethod</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">findAccessorMethod</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">propertyFromBean</span><span class="o">(</span><span class="n">givenContext</span><span class="o">,</span> <span class="n">jacksonProperty</span><span class="o">))</span>
        <span class="o">.</span><span class="na">or</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;()));</span>
  <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="n">AnnotatedField</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">findField</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">jacksonProperty</span><span class="o">.</span><span class="na">getInternalName</span><span class="o">())</span>
        <span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">propertyFromField</span><span class="o">(</span><span class="n">givenContext</span><span class="o">,</span> <span class="n">jacksonProperty</span><span class="o">))</span>
        <span class="o">.</span><span class="na">or</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;()));</span>
  <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="n">AnnotatedParameter</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ModelContext</span> <span class="n">modelContext</span> <span class="o">=</span> <span class="n">ModelContext</span><span class="o">.</span><span class="na">fromParent</span><span class="o">(</span><span class="n">givenContext</span><span class="o">,</span> <span class="n">type</span><span class="o">);</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">fromFactoryMethod</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">jacksonProperty</span><span class="o">,</span> <span class="o">(</span><span class="n">AnnotatedParameter</span><span class="o">)</span> <span class="n">member</span><span class="o">,</span> <span class="n">modelContext</span><span class="o">));</span>
  <span class="o">}</span>
 <span class="o">...</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这里根据 <code>AnnotatedMember</code>判断类成员的类型，进行不同的处理。enum使用的是 <code>propertyFromBean</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="o">...</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ModelProperty</span><span class="o">&gt;</span> <span class="nf">apply</span><span class="o">(</span><span class="n">ResolvedMethod</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ResolvedType</span> <span class="n">type</span> <span class="o">=</span> <span class="n">paramOrReturnType</span><span class="o">(</span><span class="n">typeResolver</span><span class="o">,</span> <span class="n">input</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">givenContext</span><span class="o">.</span><span class="na">canIgnore</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">shouldUnwrap</span><span class="o">(</span><span class="n">input</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">propertiesFor</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">fromParent</span><span class="o">(</span><span class="n">givenContext</span><span class="o">,</span> <span class="n">type</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">newArrayList</span><span class="o">(</span><span class="n">beanModelProperty</span><span class="o">(</span><span class="n">input</span><span class="o">,</span> <span class="n">jacksonProperty</span><span class="o">,</span> <span class="n">givenContext</span><span class="o">));</span>
    <span class="o">}...</span>
    <span class="o">}};</span></code></pre></td></tr></table>
</div>
</div>
<p>接着是 <code>beanModelProperty</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">ModelProperty</span> <span class="nf">beanModelProperty</span><span class="o">(</span>
    <span class="o">...</span>
  <span class="k">return</span> <span class="n">schemaPluginsManager</span><span class="o">.</span><span class="na">property</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">ModelPropertyContext</span><span class="o">(</span><span class="n">propertyBuilder</span><span class="o">,</span>
          <span class="n">jacksonProperty</span><span class="o">,</span>
          <span class="n">typeResolver</span><span class="o">,</span>
          <span class="o">...</span></code></pre></td></tr></table>
</div>
</div>
<p>最后调用了 <code>schemaPluginsManager.property</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">ModelProperty</span> <span class="nf">property</span><span class="o">(</span><span class="n">ModelPropertyContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// 根据文档类型取出 ModelPropertyBuilderPlugin
</span><span class="c1"></span>  <span class="k">for</span> <span class="o">(</span><span class="n">ModelPropertyBuilderPlugin</span> <span class="n">enricher</span> <span class="o">:</span> <span class="n">propertyEnrichers</span><span class="o">.</span><span class="na">getPluginsFor</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getDocumentationType</span><span class="o">()))</span> <span class="o">{</span>
    <span class="n">enricher</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="na">getBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>ModelPropertyBuilderPlugin</code>是一个接口，看它的其中一个实现类<code>ApiModelPropertyPropertyBuilder</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">ModelPropertyContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// 取出元素的注解
</span><span class="c1"></span>  <span class="n">Optional</span><span class="o">&lt;</span><span class="n">ApiModelProperty</span><span class="o">&gt;</span> <span class="n">annotation</span> <span class="o">=</span> <span class="n">Optional</span><span class="o">.</span><span class="na">absent</span><span class="o">();</span>
  <span class="o">...</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">context</span><span class="o">.</span><span class="na">getBuilder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">allowableValues</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toAllowableValues</span><span class="o">()).</span><span class="na">orNull</span><span class="o">())</span>
        <span class="o">.</span><span class="na">required</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toIsRequired</span><span class="o">()).</span><span class="na">or</span><span class="o">(</span><span class="kc">false</span><span class="o">))</span>
        <span class="o">.</span><span class="na">readOnly</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toIsReadOnly</span><span class="o">()).</span><span class="na">or</span><span class="o">(</span><span class="kc">false</span><span class="o">))</span>
        <span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toDescription</span><span class="o">()).</span><span class="na">orNull</span><span class="o">())</span>
        <span class="o">.</span><span class="na">isHidden</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toHidden</span><span class="o">()).</span><span class="na">or</span><span class="o">(</span><span class="kc">false</span><span class="o">))</span>
        <span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toType</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getResolver</span><span class="o">())).</span><span class="na">orNull</span><span class="o">())</span>
        <span class="o">.</span><span class="na">position</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toPosition</span><span class="o">()).</span><span class="na">or</span><span class="o">(</span><span class="n">0</span><span class="o">))</span>
        <span class="o">.</span><span class="na">example</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">toExample</span><span class="o">()).</span><span class="na">orNull</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>可以看到通过判断是否存在注解，再设置具体的配置。</p>

<p>其中<code>type</code>就是<code>enum</code>展示的类型了，可以固定。<code>allowableValues</code>就是<code>enum</code>的<code>value</code>,可以自定义，还可以加入<code>description</code>.</p>

<p>具体实现可以通过重写<code>ApiModelPropertyPropertyBuilder</code>的<code>apply</code>实现。</p>

<p>到这里，两个问题都得到解决。Springfox的加载过程也基本介绍了一遍。</p>

    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://llc687.top/tags/springfox/">SpringFox</a>
          <a href="https://llc687.top/tags/swagger/">“Swagger&#34;</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/swagger-codegen%E4%BD%BF%E7%94%A8/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Swagger-Codegen使用</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/hadoop%E4%B8%8Ehive/">
            <span class="next-text nav-default">“MapReduce及Hive&#34;</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "liyifan687/comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:lyfa687@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/liyifan687" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://llc687.top/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        lyf687
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  











  <script>
    $("#openSearch, #openSearchMobile").click(function(){
      $(".modal-dialog").addClass("visible");
    });

    $("#closeSearch").click(function(){
      $(".modal-dialog").removeClass("visible");
    });

    $(document).click(function(event) {
    
      if (!$(event.target).closest(".modal-content, #openSearch, #openSearchMobile").length) {
        $("body").find(".modal-dialog").removeClass("visible");
      }
    });
  </script>





</body>
</html>
